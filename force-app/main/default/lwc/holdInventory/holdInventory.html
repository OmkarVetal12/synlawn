<template>
    <lightning-card>

        <!-- SCREEN 1 : SELECT PRODUCTS -->
        <template if:true={isSelectScreen}>
            <div class="slds-p-around_medium">
                <h2 class="slds-text-heading_medium">Select Products</h2>
            </div>

            <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                <thead>
                    <tr>
                        <th></th>
                        <th>Product Name</th>
                        <th>Family</th>
                        <th>Quote Quantity</th>
                        <th>Held Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={productList} for:item="product">
                        <tr key={product.id}>
                            <td>
                                <lightning-input
                                    type="checkbox"
                                    data-id={product.id}
                                    onchange={handleProductSelection}>
                                </lightning-input>
                            </td>
                            <td>{product.name}</td>
                            <td>{product.family}</td>
                            <td>{product.quantity}</td>
                            <td>{product.onHold}</td>
                        </tr>
                    </template>
                </tbody>
            </table>

            <div class="slds-p-around_medium slds-text-align_right">
                <lightning-button
                    variant="brand"
                    label="Next"
                    onclick={handleNext}
                    disabled={isNextDisabled}>
                </lightning-button>
            </div>
        </template>

        <!-- SCREEN 2 : INVENTORY VALIDATION -->
        <template if:true={isInventoryScreen}>
            <div class="slds-p-around_medium">
                <h2 class="slds-text-heading_medium">Inventory</h2>
            </div>

            <!-- Filters -->
            <div class="slds-grid slds-gutters slds-p-horizontal_medium">
                <div class="slds-col">
                    <lightning-input
                        label="Filter by Product"
                        onchange={handleProductFilterChange}>
                    </lightning-input>
                </div>
                <div class="slds-col">
                    <lightning-input
                        label="Filter by Location"
                        onchange={handleLocationFilterChange}>
                    </lightning-input>
                </div>
            </div>

            <table class="slds-table slds-table_cell-buffer slds-table_bordered slds-m-top_medium">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Location</th>
                        <th>Available</th>
                        <th>Held Quantity</th>
                        <th>Hold Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <template for:each={visibleInventoryData} for:item="row">
                        <tr key={row.productItemId}>
                            <td>{row.productName}</td>
                            <td>{row.locationName}</td>
                            <td>{row.availableQty}</td>
                            <td>{row.quantityOnHold}</td>
                            <td>
                                <lightning-input
                                    type="number"
                                    min="0"
                                    max={row.availableQty}
                                    data-id={row.productItemId}
                                    onchange={handleHoldQuantityChange}>
                                </lightning-input>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>

            <div class="slds-p-around_medium slds-text-align_right">
                <lightning-button
                    label="Back"
                    onclick={handleBack}>
                </lightning-button>

                <lightning-button
                    class="slds-m-left_small"
                    variant="brand"
                    label="Confirm"
                    onclick={handleConfirm}>
                </lightning-button>
            </div>
        </template>

    </lightning-card>
</template>